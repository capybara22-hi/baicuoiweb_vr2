<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/assets/css/style_header.css">
    <title>Danh Sách Sinh Viên</title>
    
    <style type="text/css">
        .quaylai{
            display: flex;
            justify-content: flex-end;
        }
        .quaylai button {
            width: 100px;
            height: 60px;
            margin-top: 10px;
            background-color: #cf6363;
            font-size: 15px;
            font-weight: bold;
            color: #ffffff;
            cursor: pointer;
         
           
            
        }
        .quaylai button:hover {
            background-color: #1e40af;
            transition: 0.5s;
        }

        body {
            margin: 0;
            padding: 0;

        }

        .khoi1 {
            width: 1400px;
            padding: 30px;
            margin: 0 auto;
            background-color: white;
        }
        .khoi1 .boc{
            background-color: #cf6363;
            height: 60px;
            text-align: center;
            line-height: 60px;
            color: #ffffff;
        }

        table {
            width: 100%;
            max-width: 1400px;
            border-collapse: collapse;
            /* margin-top: 1rem;  1rem = 1.6px */
        }

        th,
        td {
            padding: 6px;
            border: 1px solid #1e3a8a;
            text-align: left;
            font-size: 14px;
        }

        th {
            background-color: #1e40af;
            color: #ffffff;
        }

        td {
            background-color: #ffffff;
        }
        footer{
        width: 100% ;
        background-color: #07184a;
        height: 400px;
        margin-top: 30px ;
        padding: 0px 70px ;
        padding-top: 57px;

        }
        footer .top{
            display: flex;
            height: 300px;
            justify-content: space-around;

        }
        footer .box{
            width: 480px;
            color :#fff; 
            text-align: center;

        }
        footer .box .logo{
            margin-bottom: 15px;
        }
        footer .box .logo p.p1{
            margin-top: 5px ;
            font-size: 14px;
            font-weight: bold;
        }
        footer .box .logo p.p2{
            font-size: 13px;
            font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
        }

        footer .box .logo img{
            width: 270px ;
            height: 120px ;
            box-shadow: 0 0 15px 0 rgba(134, 131, 131, 0.458);
            /* border-radius: 15px ; */
        }
        .logo .inf{
            width: 280px;
            margin: 20px auto;
            padding-left:20px ;

        
        }
        footer .box .logo .inf .item{
            display: flex;
            margin-top: 8px;
        }
        footer .box .logo .inf .item p {
        margin-left: 8px;
        font-size: 14px;
        }
        footer .box1{
            width: 300px;   
            text-align: left;
            margin: 28px auto;

        }
        footer .box1 .quick-menu{
            margin-top: 20px ;
        }
        footer .box1 .quick-menu .item{
            margin-left: 3px;
            margin-bottom: 12px;
            
        }
        footer .box1 h3{
            font-size: 18px;
            color:#ffffff9a;
        }
        footer .box1 .quick-menu .item a{
            color: #fff;
            text-decoration: none;
            font-size: 15px;
        }
        footer .box1 form input{
            width: 294px ;
            
            height: 42px;
            background: transparent;
            padding-left: 20px;
            color: #fff;
            margin-top: 30px ;
        }
        footer .box1 form button{
            background: #362f2f;
            box-shadow: 5px 5px 4px rgba(0,0,0.25);
            width: 163px;
            height: 38px;
            margin-top: 29px ;
            color:#fff;
        }
        footer .buttom hr{
            color: #ffffffa3;
        }
        footer .buttom p{
            color: #ffffffa3;
            text-align: center;
            margin-top: 8px;
        } 
    </style>
</head>
<body>
    <header>
        <!-- Phần thông tin liên lạc và đăng nhập/đăng ký -->
         <div id="header_contact">
            <div class="block_infor">
                <a href="">(028)37252001</a>
                <span style="opacity: 0.3;">|</span>
                <a href="">inf@hnue.edu.vn</a>
            </div>
            <div class="block_login">
                <a href="">Bảng vàng thành tích</a>
                <div id = "th">
                    <div id="acount">
                        <a href="#"><div id = "thongtin"></div></a>
                        <a href="./dangki.html" id = "thongtin1"></a>
                    </div>
                    <a href="./dangki.html" id = "dangnhap">Đăng nhập / Đăng kí</a>
                    
                </div>
                
            </div>
            <script>
                window.onload = function(){
                    const loggedInUser = JSON.parse(localStorage.getItem('loggedInUser')); 
                    console.log(loggedInUser); // In ra để kiểm tra dữ liệu

                    if (loggedInUser && loggedInUser.email) {
                        // Hiển thị tên người dùng trong div thongtin
                        document.getElementById('thongtin').innerText = loggedInUser.email; 
                        // Ẩn các liên kết đăng ký và đăng nhập
                        document.getElementById('dangnhap').style.display = 'none'; 
                        document.getElementById('thongtin1').innerText = '| Đăng xuất'
                        
                    } else {
                        // Nếu chưa đăng nhập, hiển thị thông tin mặc định
                        document.getElementById("thongtin").innerText = ''; 
                        documnet.getElementById("thongtin1").innerText = '';
                        
                    }
                }

            </script>
         </div>
         <div style="width: 85%; margin: auto;">
            <hr color="#0e2D80">
         </div>

        <!-- Phần logo trường, tên trường và slogan -->
         <div id="header_slogan">
                <div class="header_name">
                    <!-- <div class="img_logo"> -->
                        <img src="/assets/img/img_header/logo_blue.svg" alt="">
                    <!-- </div> -->
                    <div class="name_school">
                        <h2>TRƯỜNG ĐẠI HỌC SƯ PHẠM HÀ NỘI</h2>
                        <h3>Hanoi National University of Education</h3>
                    </div>
                </div>
    
                <div class="title">
                    <h2>THÔNG TIN TUYỂN SINH NĂM 2024</h2>
                </div>
         </div>
         <div style="width: 85%; margin: auto;">
            <hr color="#0e2D80">
         </div>
         
        <!-- Phần navigation -->
         <div id="header_nav">
            <ul class="menu">
                <li>
                    <a href="/index.html">Trang chủ</a>
                    <ul class="menu_1">
                        <li class="menu_1-list">
                            <a href="">
                                Tổng quan
                                <ul class="menu_2 hover_1">
                                    <li><a href="https://hnue.edu.vn/gioithieu/lichsutruyenthong">Lịch sử truyền thống</a></li>
                                    <li><a href="https://hnue.edu.vn/gioithieu/sumangvatamnhin">Sứ mệnh, tầm nhìn và giá trị</a></li>
                                    <li><a href="">Danh hiệu - Khen thưởng</a></li>
                                    <li><a href="https://hnuemapforyou.netlify.app/login.html">Bản đồ trường</a></li>
                                </ul>
                            </a>
                            <i class="fa-solid fa-chevron-right arrow"></i>
                        </li>
                        <li class="menu_1-list">
                            <a href="">
                                Ba công khai
                                <ul class="menu_2 hover_2">
                                    <li><a href="">Chất lượng đào tạo</a></li>
                                    <li><a href="https://hnue.edu.vn/gioithieu/cosovatchat">Cơ sở vật chất</a></li>
                                    <li><a href="https://hnue.edu.vn/gioithieu/DoiNguCanBo">Đội ngũ cán bộ</a></li>
                                </ul>
                            </a>
                            <i class="fa-solid fa-chevron-right arrow"></i>
                        </li>
                        <li><a href="https://hnue.edu.vn/gioithieu/cocautochuc">Cơ cấu tổ chức</a></li>
                    </ul>
                </li>
                <a href="./daotao.html"><li>
                    Đào tạo
                    <ul class="menu_1">
                        <li><a href="./daotao.html">Đào tạo Đại học</a></li>
                        <li><a href="./daotao.html">Đào tạo Thạc sĩ</a></li>
                        <li><a href="./daotao.html">Đào tạo Tiến sĩ</a></li>
                    </ul>
                </li></a>
                <li>
                    <a href="./tintuc.html">Tin tức</a>
                    
                    <ul class="menu_1">
                        <li><a href="./tintuc.html">Tin tuyển sinh</a></li>
                        <li><a href="./tintuc.html">Tin đào tạo</a></li>
                        <li><a href="./tintuc.html">Hoạt động chung</a></li>
                        <li><a href="./tintuc.html">Thông tin & Báo chí</a></li>

                    </ul>
                </li>
                <li>
                    <a href="./diemchuan.html">Điểm chuẩn</a>
                 
                    <ul class="menu_1">
                        <li><a href="./diemchuan.html">Điểm chuẩn năm 2024</a></li>
                        <li><a href="https://vtcnews.vn/diem-chuan-truong-dai-hoc-su-pham-ha-noi-3-nam-gan-nhat-ar867273.html">Thống kê điểm</a></li>
                    </ul>
                </li>
                <li>
                    <a href="./tuyenSinh.html">Xét Tuyển</a>
                    <ul class="menu_1">
                        <li class="menu_1-list">
                            <a href="./tuyenSinh.html">
                                Xét tuyển
                            </a>
                            
                        </li>
                      
                    </ul>
                </li>
                <li><a href="./quanlihoso.html">Quản lí hồ sơ</a>
                    <ul class="menu_1">
                        <li class="menu_1-list">
                            <a href="./quanlihoso.html">
                                Quản lý hồ sơ 
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
         </div>
    </header>
    <div class="khoi1">
        <div class="boc"><h1>Danh Sách Sinh Viên Đang Chờ Xét Duyệt</h1></div>
        <table id="pendingTable">
            <thead>
                <tr>
                    <th>STT</th>
                    <th>Họ tên</th>
                    <th>Email</th>
                    <th>Số điện thoại</th>
                    <th>Số CMND/CCCD</th>
                    <th>Ngày sinh</th>
                    <th>Giới tính</th>
                    <th>Điểm lớp 10</th>
                    <th>Điểm lớp 11</th>
                    <th>Điểm lớp 12</th>
                    <th>Trạng thái</th>
                    <th>Thời gian cập nhật</th>
                    <th>Cập nhật</th>
                </tr>
            </thead>
            <tbody id="pendingBody"></tbody>
        </table>
    </div>
    <div class="khoi1">
        <div class="boc"><h1>Danh Sách Sinh Viên Đã Được Chấp Nhận</h1></div>
        <table id="infoTable">
            <thead>
                <tr>
                    <th>STT</th>
                    <th>Họ tên</th>
                    <th>Email</th>
                    <th>Số điện thoại</th>
                    <th>Số CMND/CCCD</th>
                    <th>Ngày sinh</th>
                    <th>Giới tính</th>
                    <th>Điểm lớp 10</th>
                    <th>Điểm lớp 11</th>
                    <th>Điểm lớp 12</th>
                    <th>Thời gian cập nhật</th>

                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
        <div class="quaylai">
            <a href="./quanlihoso.html"><button>Quay lại</button></a>
        </div>
        
    </div>
    <footer>
        <div class="top">

            <div class="box">
                <div class="logo">
                    <div class="img">
                        <img src="/assets/img/su-pham.jpeg" alt="">
                    </div>
                    <p class = "p1">TRƯỜNG ĐẠI HỌC SƯ PHẠM HÀ NỘI</p>
                    <p class = "p2">Hanoi National University of Education</p>

                    <div class="inf">
                        <div class="item">
                            <i class="fa-solid fa-location-dot"></i><p>136 Xuân Thủy - Cầu Giấy - Hà Nội</p>
                        </div>
                        <div class="item">
                            <i class="fa-solid fa-phone"></i><p>024-37547823   fax: 024-37547971</p>
                        </div>
                        <div class="item">
                            <i class="fa-solid fa-envelope"></i><p>p.hcdn@hnue.edu.vn</p>
                        </div>
                        <div class="item">
                            <i class="fa-solid fa-building"></i><p>http://www.hnue.edu.vn</p>
                        </div>
                    </div>
                    
    
                </div>
            </div>
            <div class="box1">
                <h3>GIỚI THIỆU CHUNG </h3>
                    <ul class = "quick-menu">
                        <div class="item">
                            <a href="https://hnue.edu.vn/gioithieu/sumangvatamnhin">Tại sao nên chọn HNUE </a>
                        </div>
                        <div class="item">
                            <a href="https://hnue.edu.vn/Gi%E1%BB%9Bi-thi%E1%BB%87u">Giới thiệu về trường</a>
                        </div>
                        <div class="item">
                            <a href="https://staff.hnue.edu.vn/Gioithieu/Donvithuoctruong.aspx">Các khoa & Trung tâm</a>
                        </div>
                        <div class="item">
                            <a href="https://hnue.edu.vn/lienhe">Tìm đường đến HNUE</a>
                        </div>
                    </ul>    
            </div>
            <div class = "box1">
                <h3>HỌC TẬP TẠI HNUE</h3>
                <ul class = "quick-menu">
                    <div class="item">
                        <a href="https://tuyensinh.hnue.edu.vn/nganh-dao-tao">Đào tại Đại học </a>
                    </div>
                    <div class="item">
                        <a href="https://sdh.hnue.edu.vn/">Đào tạo Sau Đại học</a>
                    </div>
                    <div class="item">
                        <a href="https://tuyensinh.hnue.edu.vn/nganh-dao-tao">Đào tạo - Bồi dưỡng</a>
                    </div>
                    <div class="item">
                        <a href="https://dtdh.hnue.edu.vn/">Học bổng - Học phí</a>
                    </div>
                </ul>
            </div>
            <div class="box1">
                <h3>LIÊN HỆ</h3>
                <form action="">
                    <input type="text" placeholder ="Địa chỉ email">
                    <button> Nhập tin</button>
                </form>
            </div>
        </div>
        <div class="buttom">
            <hr>
            <p>Copyright 2024 by Trường Đại học Sư phạm Hà Nội</p>
        </div>

    </footer>
    <script>
        const students = JSON.parse(localStorage.getItem("students")) || [];
        const tableBody = document.getElementById("tableBody");
        const pendingBody = document.getElementById("pendingBody");
        // Khi tạo hoặc cập nhật sinh viên, thêm timestamp
        
        students.forEach(student => {
            if (!student.timestamp) {
                student.timestamp = new Date().toLocaleString(); // Thêm timestamp cho dữ liệu cũ
            }
        });
        localStorage.setItem("students", JSON.stringify(students)); // Lưu lại dữ liệu

        // lấy thông tin từ người dùng đăng nhập
        const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser")) || null; 
        const isAdmin = loggedInUser && (loggedInUser.email === "cao@gmail.com" || loggedInUser.email === "tuan@gmail.com");

        // Hiển thị danh sách đang chờ duyệt
        function displayPendingStudents() {
            pendingBody.innerHTML = ""; // Xóa nội dung cũ

            students.forEach((student, index) => {
                if (student.status === "pending" || student.status === "yeucau") {
                    const row = document.createElement("tr");
                    row.innerHTML = ` 
                        <td>${index + 1}</td>
                        <td>${student.hoTen}</td>
                        <td>${student.email}</td>
                        <td>${student.sdt}</td>
                        <td>${maskCCCD(student.cccd)}</td>
                        <td>${student.ngaySinh}</td>
                        <td>${student.gioiTinh}</td>
                        <td>${student.diem10}</td>
                        <td>${student.diem11}</td>
                        <td>${student.diem12}</td>
                        <td>${student.status === "yeucau" ? "Yêu cầu chỉnh sửa lại" : "Đang chờ xét duyệt"}</td> 
                        <td>${student.timestamp || "N/A"}</td> 
                        ${loggedInUser && loggedInUser.email === student.email ? `<td><button onclick="updateStudent(${index})">Cập nhật</button></td>` : `<td></td>`}
                    `;


                    /*comment 
                    <td>${student.status === "yeucau" ? "Yêu cầu chỉnh sửa lại" : "Đang chờ xét duyệt"}</td> 
                    condition ? expression_if_true : expression_if_false
                    
                    */ 

                    pendingBody.prepend(row);
                }
            });
        }
       
        // Kiểm tra dữ liệu mẫu
        console.log(loggedInUser); // Kiểm tra giá trị console khi chạy trang

        // Hiển thị danh sách đã được chấp nhận
        function displayAcceptedStudents() {
            tableBody.innerHTML = ""; 
            students.forEach((student, index) => {
                if (student.status === "accepted") {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${student.hoTen}</td>
                        <td>${student.email}</td>
                        <td>${student.sdt}</td>
                        <td>${maskCCCD(student.cccd)}</td>
                        <td>${student.ngaySinh}</td>
                        <td>${student.gioiTinh}</td>
                        <td>${student.diem10}</td>
                        <td>${student.diem11}</td>
                        <td>${student.diem12}</td>
                        <td>${student.timestamp || "N/A"}</td> 
                       
                    `;
                    tableBody.prepend(row);
                }
            });
        }

        // Update thông tin sinh viên 
        function updateStudent(index) {
            students.splice(index, 1); // thêm 1 sinh viên 
            localStorage.setItem("students", JSON.stringify(students)); // Cập nhật localStorage
            displayAcceptedStudents(); // Hiển thị lại danh sách
            alert("Đã xóa thông tin sinh viên, Yêu cầu đăng kí lại");
            // vào lại trang đăng kí đăng kí lại
            window.location.href = "./student-form.html"
        }
    
        function maskCCCD(cccd){
            return cccd.substring(0,5) + "*****" + cccd.substring(cccd.length -3 );
        }
       
        // Gọi các hàm hiển thị
        displayPendingStudents();
        displayAcceptedStudents();
    </script>
</body>
</html>
